
#include <string.h>
#include <stdlib.h>
#include <stdio.h>

int* p_cookie;

void check(int* _cookie, int _cookie2)
	{
		if (*_cookie == 0x710D0A53)
		{
			*_cookie += _cookie2;
		
		}
		return;

	}

int main(int argc, char *argv[])
{
  char Dest[100]; // [sp+0h] [bp-A0h]@3
  char buffer[50]; // [sp+64h] [bp-3Ch]@3
  int cookie2 = 0; // [sp+98h] [bp-8h]@1
  int cookie = 0; // [sp+9Ch] [bp-4h]@1

  if ( argc != 2 )
    exit(1);
  p_cookie = &cookie;
  
 printf("buf: %08x cookie: %08x cookie2: %08x\n", (unsigned int)&buffer, (unsigned int)&cookie, (unsigned int)&cookie2);
 
  strncpy(Dest, argv[0], 60);
  
  if (*argv[1] != 0x40)
    exit(1);
    
  strncpy(buffer, argv[1], 160);
  
  check(p_cookie, cookie2);
  
  printf("cookie %08x \n", cookie);
  
  if ( cookie == 0x350D0A58 )
    printf("You win man\n");
  else
    printf("You lose man \n");
  return 0;
}
